#include "testApp.h"

///////////////////////////////////////////////////////////////////////////////////
// setup --------------------------------------------------------------------------
///////////////////////////////////////////////////////////////////////////////////
void testApp::setup(){	
	ofSetVerticalSync(true);
	ofBackground(0, 0, 0);
	ofSetFullscreen(true);
	
	capture.initGrabber(640,480);
	
	cm.setup(640, 480);
	
	settings.setup('a', "App.xml");
}

///////////////////////////////////////////////////////////////////////////////////
// update -------------------------------------------------------------------------
///////////////////////////////////////////////////////////////////////////////////
void testApp::update(){
	capture.grabFrame();
	
	if (capture.isFrameNew())
		cm.update(capture.getPixels());	
}
///////////////////////////////////////////////////////////////////////////////////
// draw ---------------------------------------------------------------------------
///////////////////////////////////////////////////////////////////////////////////
void testApp::draw(){
	ofSetColor(255, 255, 255);
	if(cm.isReady())
		cm.draw(0, 0, ofGetWidth(), ofGetHeight());
	
	ofSetColor(0, 0, 0);
	ofCircle(500, 500, 20);
}
///////////////////////////////////////////////////////////////////////////////////
// keyPressed ---------------------------------------------------------------------
///////////////////////////////////////////////////////////////////////////////////
void testApp::keyPressed(int key){	
	if (key=='s')
		capture.videoSettings();
	
	if (key==' ')
		ofToggleFullscreen();
	
	if (key=='-')
		cm.setStoredFrames( cm.getStoredFrames() - 1 );
	
	if (key=='+')
		cm.setStoredFrames( cm.getStoredFrames() + 1 );
	
	settings.proccessKey(key);
}
